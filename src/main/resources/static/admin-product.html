<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ê´€ë¦¬ - ì‹¹ì“°ë¦¬ ê´€ë¦¬ì</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple SD Gothic Neo', sans-serif;
            background: #fafafa;
            min-height: 100vh;
        }

        header {
            background: #ffffff;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #f0f0f0;
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            background: linear-gradient(135deg, #74b9ff 0%, #a29bfe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            cursor: pointer;
        }

        .header-title { flex: 1; font-size: 20px; font-weight: 600; color: #212529; display: flex; align-items: center; gap: 8px; }
        .header-icons { display: flex; gap: 12px; }

        .btn-common { padding: 10px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer; border: none; transition: 0.2s; }
        .home-btn { background: linear-gradient(135deg, #74b9ff 0%, #a29bfe 100%); color: white; box-shadow: 0 4px 12px rgba(116,185,255,0.3); }
        .home-btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .logout-btn { background: #f8f9fa; color: #495057; }
        .logout-btn:hover { background: #e9ecef; }

        .container { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }

        .page-header {
            background: linear-gradient(135deg, #74b9ff 0%, #a29bfe 100%);
            padding: 40px;
            border-radius: 24px;
            margin-bottom: 40px;
            color: white;
            box-shadow: 0 10px 40px rgba(116,185,255,0.25);
        }

        .tab-section { display: flex; gap: 12px; margin-bottom: 24px; }
        .tab-btn { padding: 12px 24px; border-radius: 12px; border: none; background: white; color: #495057; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.04); transition: 0.2s; }
        .tab-btn.active { background: #74b9ff; color: white; }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           í•„í„° ì„¹ì…˜: ì¹´í…Œê³ ë¦¬ + ìƒí’ˆ ë“±ë¡ ë²„íŠ¼
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .filter-section {
            background: white;
            padding: 20px 24px;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            display: flex;
            gap: 16px;
            align-items: center;
        }
        .filter-section label { font-size: 14px; font-weight: 600; color: #495057; white-space: nowrap; }
        .filter-section select { width: 200px; padding: 10px 12px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 14px; outline: none; cursor: pointer; }
        .filter-section select:focus { border-color: #74b9ff; }

        /* ì˜¤ë¥¸ìª½ ë ìƒí’ˆ ë“±ë¡ ë²„íŠ¼ */
        .filter-spacer { flex: 1; }

        /* ìƒí’ˆ ë“±ë¡ ë²„íŠ¼ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        .create-btn, .home-btn {
            background-color: #3498db !important; /* ë©”ì¸ íŒŒë€ìƒ‰ */
            color: white !important;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .create-btn:hover, .home-btn:hover {
            background-color: #2980b9 !important;
        }

        /* ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ë¹¨ê°„ìƒ‰) */
        .delete-btn {
            background-color: #e74c3c !important;
            color: white !important;
            margin-right: auto; /* ì™¼ìª½ ëìœ¼ë¡œ ë°°ì¹˜ */
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           í…Œì´ë¸”
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .table-container { background: white; border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8f9fa; padding: 16px 24px; text-align: left; font-size: 13px; color: #495057; border-bottom: 1px solid #e9ecef; }
        td { padding: 16px 24px; font-size: 14px; color: #495057; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
        tr:hover td { background: #f8f9fa; }
        tbody tr { cursor: pointer; }

        .status-badge { padding: 4px 12px; border-radius: 8px; font-size: 12px; font-weight: 600; }
        .status-BEFORE_SALE { background: #f3f0ff; color: #7950f2; }
        .status-FOR_SALE    { background: #e3f2fd; color: #1976d2; }
        .status-STOP_SALE   { background: #fff3e0; color: #e65100; }
        .status-SOLD_OUT    { background: #ffebee; color: #d32f2f; }
        .status-ACTIVE      { background: #e3f2fd; color: #1976d2; }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           í˜ì´ì§€ë„¤ì´ì…˜
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .pagination { display: flex; justify-content: center; align-items: center; padding: 24px; gap: 6px; flex-wrap: wrap; }
        .page-btn {
            min-width: 36px;
            height: 36px;
            padding: 0 10px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            cursor: pointer;
            background: #fff;
            color: #495057;
            font-size: 13px;
            font-weight: 500;
            transition: 0.15s;
        }
        .page-btn:hover { background: #f0f7ff; border-color: #74b9ff; }
        .page-btn.active { background: #74b9ff; color: white; border-color: #74b9ff; font-weight: 700; }
        .page-btn.nav { font-weight: 700; color: #74b9ff; }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           ê³µí†µ ëª¨ë‹¬
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 24px; padding: 32px; width: 90%; max-width: 620px; max-height: 90vh; overflow-y: auto; animation: slideUp 0.3s; }
        @keyframes slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        .modal-title { font-size: 20px; font-weight: 700; color: #212529; margin-bottom: 24px; }
        .form-group { margin-bottom: 16px; }
        .form-row { display: flex; gap: 16px; }
        .form-row .form-group { flex: 1; }
        label { display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #495057; }
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 11px 14px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.15s;
            font-family: inherit;
        }
        input:focus, select:focus, textarea:focus { border-color: #74b9ff; }
        textarea { resize: vertical; min-height: 80px; }

        /* ì´ë¯¸ì§€ URL ì…ë ¥ë€ â€“ ì„ íƒì ì„ì„ í‘œì‹œ */
        .optional-label::after { content: ' (ì„ íƒ)'; font-weight: 400; color: #adb5bd; }

        .modal-footer { display: flex; justify-content: flex-end; gap: 12px; margin-top: 28px; }

        .empty-row td { text-align: center; padding: 40px; color: #adb5bd; }
    </style>
</head>
<body>

<header>
    <div class="logo" onclick="location.href='home.html'">ğŸŒŠ ì‹¹ì“°ë¦¬</div>
    <div class="header-title">ğŸ›¡ï¸ ìƒí’ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ</div>
    <div class="header-icons">
        <button class="btn-common home-btn" onclick="location.href='home.html'">í™ˆìœ¼ë¡œ</button>
        <button class="btn-common logout-btn" id="logoutBtn">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
</header>

<div class="container">
    <div class="page-header">
        <h1>ìƒí’ˆ ë°ì´í„° ê´€ë¦¬</h1>
        <p id="totalCountDisplay">ì „ì²´ ìƒí’ˆ 0ê°œ | ì‹¤ì‹œê°„ ì¬ê³ ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”</p>
    </div>

    <div class="tab-section">
        <button class="tab-btn active">ğŸ“¦ ìƒí’ˆ ê´€ë¦¬</button>
        <button class="tab-btn" onclick="location.href='admin-timedeal.html'">âš¡ íƒ€ì„ë”œ ê´€ë¦¬</button>
    </div>

    <!-- í•„í„° + ìƒí’ˆ ë“±ë¡ ë²„íŠ¼ -->
    <div class="filter-section">
        <label>ì¹´í…Œê³ ë¦¬</label>
        <select id="categoryFilter" onchange="loadProducts(0)">
            <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
        </select>
        <div class="filter-spacer"></div>
        <button class="create-btn" onclick="openCreateModal()">+ ìƒí’ˆ ë“±ë¡</button>
    </div>

    <div class="table-container">
        <table>
            <thead>
            <tr>
                <th>ID</th>
                <th>ìƒí’ˆ ì •ë³´</th>
                <th>ì¹´í…Œê³ ë¦¬</th>
                <th>ê°€ê²©</th>
                <th>ì¬ê³ </th>
                <th>ìƒíƒœ</th>
                <th>ë“±ë¡ì¼</th>
            </tr>
            </thead>
            <tbody id="productTableBody">
            <tr class="empty-row"><td colspan="7">ë¡œë”© ì¤‘...</td></tr>
            </tbody>
        </table>
        <div id="pagination" class="pagination"></div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ìƒí’ˆ ë“±ë¡ ëª¨ë‹¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal" id="productCreateModal">
    <div class="modal-content">
        <div class="modal-title">ğŸ“¦ ìƒí’ˆ ë“±ë¡</div>

        <div class="form-group">
            <label>ì¹´í…Œê³ ë¦¬ <span style="color:#e74c3c">*</span></label>
            <select id="createCategorySelect">
                <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
            </select>
        </div>

        <div class="form-group">
            <label>ìƒí’ˆëª… <span style="color:#e74c3c">*</span></label>
            <input type="text" id="createName" placeholder="ìƒí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>ê°€ê²© (ì›) <span style="color:#e74c3c">*</span></label>
                <input type="number" id="createPrice" placeholder="0" min="0">
            </div>
            <div class="form-group">
                <label>ì¬ê³  ìˆ˜ëŸ‰ <span style="color:#e74c3c">*</span></label>
                <input type="number" id="createQuantity" placeholder="0" min="0">
            </div>
        </div>

        <div class="form-group">
            <label>ìƒí’ˆ ì„¤ëª…</label>
            <textarea id="createInformation" placeholder="ìƒí’ˆ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
        </div>

        <div class="form-group">
            <label>íŒë§¤ ìƒíƒœ <span style="color:#e74c3c">*</span></label>
            <select id="createStatus">
                <option value="BEFORE_SALE">íŒë§¤ì „</option>
                <option value="FOR_SALE">íŒë§¤ì¤‘</option>
                <option value="STOP_SALE">íŒë§¤ì¤‘ì§€</option>
                <option value="SOLD_OUT">í’ˆì ˆ</option>
            </select>
        </div>

        <div class="form-group">
            <label class="optional-label">ëŒ€í‘œ ì´ë¯¸ì§€ URL</label>
            <input type="text" id="createImageUrl" placeholder="https://... (ë‚˜ì¤‘ì— ë“±ë¡ ê°€ëŠ¥)">
        </div>

        <div class="form-group">
            <label class="optional-label">ìƒì„¸ ì´ë¯¸ì§€ URL</label>
            <input type="text" id="createDetailImageUrl" placeholder="https://... (ë‚˜ì¤‘ì— ë“±ë¡ ê°€ëŠ¥)">
        </div>

        <div class="modal-footer">
            <button class="btn-common logout-btn" onclick="closeCreateModal()">ì·¨ì†Œ</button>
            <button class="btn-common home-btn" onclick="createProduct()">ë“±ë¡í•˜ê¸°</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ìƒí’ˆ ìˆ˜ì • ëª¨ë‹¬
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal" id="editModal">
    <div class="modal-content">
        <div class="modal-title">âœï¸ ìƒí’ˆ ìƒì„¸ / ìˆ˜ì •</div>

        <div class="form-group">
            <label>ì¹´í…Œê³ ë¦¬</label>
            <select id="editCategorySelect">
                <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
            </select>
        </div>

        <div class="form-group">
            <label>ìƒí’ˆëª…</label>
            <input type="text" id="editName" placeholder="ìƒí’ˆëª…">
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>ê°€ê²© (ì›)</label>
                <input type="number" id="editPrice" min="0">
            </div>
            <div class="form-group">
                <label>ì¬ê³  ìˆ˜ëŸ‰</label>
                <input type="number" id="editQuantity" min="0">
            </div>
        </div>

        <div class="form-group">
            <label>ìƒí’ˆ ì„¤ëª…</label>
            <textarea id="editInformation" placeholder="ìƒí’ˆ ì„¤ëª…"></textarea>
        </div>

        <div class="form-group">
            <label>íŒë§¤ ìƒíƒœ</label>
            <select id="editStatus">
                <option value="BEFORE_SALE">íŒë§¤ì „</option>
                <option value="FOR_SALE">íŒë§¤ì¤‘</option>
                <option value="STOP_SALE">íŒë§¤ì¤‘ì§€</option>
                <option value="SOLD_OUT">í’ˆì ˆ</option>
            </select>
        </div>

        <div class="form-group">
            <label class="optional-label">ëŒ€í‘œ ì´ë¯¸ì§€ URL</label>
            <input type="text" id="editImageUrl" placeholder="https://... (ë¹„ì›Œë‘ë©´ ê¸°ì¡´ ê°’ ìœ ì§€)">
        </div>

        <div class="form-group">
            <label class="optional-label">ìƒì„¸ ì´ë¯¸ì§€ URL</label>
            <input type="text" id="editDetailImageUrl" placeholder="https://... (ë¹„ì›Œë‘ë©´ ê¸°ì¡´ ê°’ ìœ ì§€)">
        </div>

        <div class="modal-footer">
            <button class="btn-common logout-btn" onclick="closeEditModal()">ì·¨ì†Œ</button>
            <button class="btn-common delete-btn" onclick="deleteProduct()">ì‚­ì œí•˜ê¸°</button>
            <button class="btn-common home-btn" onclick="updateProduct()">ìˆ˜ì •í•˜ê¸°</button>
        </div>
    </div>
</div>

<script>
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ì „ì—­ ìƒíƒœ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let currentId   = null;
    let currentPage = 0;
    const PAGE_GROUP_SIZE = 10;
    const BASE_URL = 'http://localhost:8080/ssak3';

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ì§„ì…ì 
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.addEventListener('DOMContentLoaded', () => {
        loadCategories();
        loadProducts(0);
    });

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ê³µí†µ fetch ì˜µì…˜
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function getRequestOptions(method = 'GET', body = null) {
        const token = localStorage.getItem('accessToken');
        const headers = { 'Content-Type': 'application/json' };
        if (token && token !== 'null' && token !== 'undefined') {
            headers['Authorization'] = `Bearer ${token}`;
        }
        const options = { method, headers, credentials: 'include' };
        if (body !== null) options.body = JSON.stringify(body);
        return options;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ì¹´í…Œê³ ë¦¬ ë¡œë“œ (í•„í„° select + ë“±ë¡/ìˆ˜ì • ëª¨ë‹¬ select ë™ê¸°í™”)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function loadCategories() {
        try {
            const res    = await fetch(`${BASE_URL}/categories`, getRequestOptions());
            const result = await res.json();

            const categories = result?.data?.content ?? [];

            // ì˜µì…˜ HTML ì¡°ê°
            const optionsHtml = categories.map(c =>
                `<option value="${c.id}">${c.name}</option>`
            ).join('');

            // í•„í„° select
            const filterEl = document.getElementById('categoryFilter');
            filterEl.innerHTML = '<option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>' + optionsHtml;

            // ë“±ë¡ ëª¨ë‹¬ select
            const createEl = document.getElementById('createCategorySelect');
            createEl.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>' + optionsHtml;

            // ìˆ˜ì • ëª¨ë‹¬ select
            const editEl = document.getElementById('editCategorySelect');
            editEl.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>' + optionsHtml;

        } catch (err) {
            console.error('ì¹´í…Œê³ ë¦¬ ë¡œë”© ì‹¤íŒ¨:', err);
        }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ìƒí’ˆ ëª©ë¡ ë¡œë“œ
    //
    // âš ï¸ ë²„ê·¸ ì›ì¸: ì¹´í…Œê³ ë¦¬6 ì„ íƒ ì‹œ í•„í„°ê°€ ì•ˆ ê±¸ë¦¬ëŠ” ì´ìœ ëŠ”
    //   categoryId ê°’ì´ ìˆ«ìì¸ë° ë¹ˆ ë¬¸ìì—´("")ê³¼ falsy ë¹„êµë¡œ
    //   í•­ìƒ íŒŒë¼ë¯¸í„°ë¥¼ ëˆ„ë½ì‹œí‚¤ëŠ” ì¼€ì´ìŠ¤ê°€ ìˆì—ˆìŒ.
    //   â†’ categoryIdê°€ 0ì´ ì•„ë‹Œ ì´ìƒ ìˆ«ìë©´ ë¬´ì¡°ê±´ íŒŒë¼ë¯¸í„° ì¶”ê°€í•˜ë„ë¡ ìˆ˜ì •.
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function loadProducts(page = 0) {
        const categoryFilter = document.getElementById('categoryFilter');

        // ğŸ’¡ 1. í˜„ì¬ ê°€ì ¸ì˜¨ ìƒ(Raw) ê°’ì„ ë¡œê·¸ë¡œ ì°ì–´ë´…ë‹ˆë‹¤.
        const rawValue = categoryFilter ? categoryFilter.value : "";
        console.log(`ğŸ” ì„ íƒëœ ì›ë³¸ ê°’: [${rawValue}] (ê¸¸ì´: ${rawValue.length})`);

        let url = `${BASE_URL}/admin/products?page=${page}&size=10`;

        // ğŸ’¡ 2. ì•„ì£¼ ë³´ìˆ˜ì ìœ¼ë¡œ ì²´í¬í•©ë‹ˆë‹¤. (ë¬¸ìì—´ "null", "undefined" ë“± ì² ì € ë°©ì–´)
        if (rawValue !== "" && rawValue !== null && rawValue !== "null") {
            const cleanId = parseInt(rawValue, 10); // ê°•ì œë¡œ ì •ìˆ˜í™” (ê³µë°± ì œê±° íš¨ê³¼)

            if (!isNaN(cleanId)) {
                url += `&categoryId=${cleanId}`;
            }
        }

        console.log(`ğŸ“¡ ìµœì¢… ìš”ì²­ URL: ${url}`);

        try {
            const response = await fetch(url, getRequestOptions());

            // ğŸ’¡ 3. ë§Œì•½ ì—¬ì „íˆ 400ì´ ëœ¬ë‹¤ë©´ ì„œë²„ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ìƒì„¸íˆ ë´…ë‹ˆë‹¤.
            if (response.status === 400) {
                const errorBody = await response.json();
                console.error("âŒ 400 ì—ëŸ¬ ìƒì„¸ ë‚´ìš©:", errorBody);
                alert(`6ë²ˆ ì¹´í…Œê³ ë¦¬ ì˜¤ë¥˜: ${errorBody.message || 'ë°ì´í„° íƒ€ì… ë¶ˆì¼ì¹˜'}`);
                return;
            }

            const result = await response.json();
            if (!result?.data) return;

            const pageData = result.data;
            currentPage = page;

            renderTable(pageData.content ?? []);
            renderPagination(pageData);

            document.getElementById('totalCountDisplay').innerText =
                `ì „ì²´ ìƒí’ˆ ${pageData.totalElements ?? 0}ê°œ | ì‹¤ì‹œê°„ ê´€ë¦¬ ì¤‘`;

        } catch (err) {
            console.error('ìƒí’ˆ ëª©ë¡ ë¡œë”© ì‹¤íŒ¨:', err);
        }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // í…Œì´ë¸” ë Œë”ë§
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderTable(products) {
        const tbody = document.getElementById('productTableBody');
        if (!tbody) return;

        if (products.length === 0) {
            tbody.innerHTML = '<tr class="empty-row"><td colspan="7">ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
            return;
        }

        tbody.innerHTML = products.map(p => {
            const img = p.imageUrl
                ? `<img src="${p.imageUrl}" width="32" height="32" style="border-radius:6px;object-fit:cover;vertical-align:middle;margin-right:8px;" onerror="this.style.display='none'">`
                : '<span style="margin-right:8px;">ğŸ“¦</span>';

            const statusLabel = {
                BEFORE_SALE: 'íŒë§¤ì „',
                FOR_SALE:    'íŒë§¤ì¤‘',
                STOP_SALE:   'íŒë§¤ì¤‘ì§€',
                SOLD_OUT:    'í’ˆì ˆ',
                ACTIVE:      'íŒë§¤ì¤‘',
            }[p.status] ?? p.status;

            return `
            <tr onclick="openEditModal(${p.id})">
                <td>${p.id}</td>
                <td>${img}<span style="font-weight:600">${p.name ?? 'ì´ë¦„ ì—†ìŒ'}</span></td>
                <td>${p.categoryName ?? '-'}</td>
                <td>${(p.price ?? 0).toLocaleString()}ì›</td>
                <td>${p.quantity ?? 0}ê°œ</td>
                <td><span class="status-badge status-${p.status}">${statusLabel}</span></td>
                <td>${p.createdAt ? p.createdAt.substring(0, 10) : '-'}</td>
            </tr>`;
        }).join('');
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // í˜ì´ì§€ë„¤ì´ì…˜ (10ë‹¨ìœ„ ê·¸ë£¹)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // [7] í˜ì´ì§€ë„¤ì´ì…˜ ìˆ˜ì • (10ë‹¨ìœ„ ì´ì „/ë‹¤ìŒ ì™„ë²½ ì§€ì›)
    function renderPagination(data) {
        const container = document.getElementById('pagination');
        if (!container) return;

        const totalPages = data.totalPages ?? 0;
        const current    = data.number ?? 0;
        const groupStart = Math.floor(current / PAGE_GROUP_SIZE) * PAGE_GROUP_SIZE;
        const groupEnd   = Math.min(groupStart + PAGE_GROUP_SIZE, totalPages);

        if (totalPages <= 1) { container.innerHTML = ''; return; }

        let html = '';

        // ğŸ’¡ í•µì‹¬: ì´ì „ ë²„íŠ¼ (í˜„ì¬ ê·¸ë£¹ì˜ ì‹œì‘ì´ 0ë³´ë‹¤ í¬ë©´ 'ì´ì „ 10ê°œ' ê·¸ë£¹ì˜ ë§ˆì§€ë§‰ í˜ì´ì§€ë¡œ ì´ë™)
        if (groupStart > 0) {
            html += `<button class="page-btn nav" onclick="loadProducts(${groupStart - 1})">ì´ì „</button>`;
        }

        // ìˆ«ì ë²„íŠ¼ë“¤
        for (let i = groupStart; i < groupEnd; i++) {
            const activeClass = (i === current) ? 'active' : '';
            html += `<button class="page-btn ${activeClass}" onclick="loadProducts(${i})">${i + 1}</button>`;
        }

        // ğŸ’¡ í•µì‹¬: ë‹¤ìŒ ë²„íŠ¼ (ë‹¤ìŒ ê·¸ë£¹ì´ ì¡´ì¬í•˜ë©´ 'ë‹¤ìŒ 10ê°œ' ê·¸ë£¹ì˜ ì²« í˜ì´ì§€ë¡œ ì´ë™)
        if (groupEnd < totalPages) {
            html += `<button class="page-btn nav" onclick="loadProducts(${groupEnd})">ë‹¤ìŒ</button>`;
        }

        container.innerHTML = html;
    }

    // [9] ìƒí’ˆ ì‚­ì œ ì‹¤í–‰
    async function deleteProduct() {
        if (!currentId) return;

        if (!confirm("ì •ë§ë¡œ ì´ ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")) {
            return;
        }

        try {
            const res = await fetch(`${BASE_URL}/admin/products/${currentId}`,
                getRequestOptions('DELETE'));

            if (res.ok) {
                alert('ìƒí’ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ğŸ—‘ï¸');
                closeEditModal();
                loadProducts(currentPage);
            } else {
                const err = await res.json().catch(() => ({}));
                alert(`ì‚­ì œ ì‹¤íŒ¨: ${err.message ?? 'ê¶Œí•œì´ ì—†ê±°ë‚˜ ì´ë¯¸ ì‚­ì œëœ ìƒí’ˆì…ë‹ˆë‹¤.'}`);
            }
        } catch (e) {
            console.error('ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', e);
            alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ìƒí’ˆ ë“±ë¡ ëª¨ë‹¬
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openCreateModal() {
        document.getElementById('createCategorySelect').value = '';
        document.getElementById('createName').value          = '';
        document.getElementById('createPrice').value         = '';
        document.getElementById('createQuantity').value      = '';
        document.getElementById('createInformation').value   = '';
        document.getElementById('createStatus').value        = 'BEFORE_SALE';
        document.getElementById('createImageUrl').value      = '';
        document.getElementById('createDetailImageUrl').value = '';
        document.getElementById('productCreateModal').classList.add('active');
    }

    function closeCreateModal() {
        document.getElementById('productCreateModal').classList.remove('active');
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ìƒí’ˆ ë“±ë¡ ì‹¤í–‰
    // POST /ssak3/admin/products
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function createProduct() {
        const categoryId = document.getElementById('createCategorySelect').value;
        const name       = document.getElementById('createName').value.trim();
        const price      = parseInt(document.getElementById('createPrice').value) || 0;
        const quantity   = parseInt(document.getElementById('createQuantity').value) || 0;
        const status     = document.getElementById('createStatus').value;

        // í•„ìˆ˜ ê°’ ê²€ì¦
        if (!categoryId) { alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
        if (!name)        { alert('ìƒí’ˆëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
        if (price <= 0)   { alert('ê°€ê²©ì„ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

        // ProductCreateRequest DTO ë§¤í•‘
        const data = {
            categoryId:  Number(categoryId),
            name,
            price,
            information: document.getElementById('createInformation').value.trim() || null,
            quantity,
            status,
            image:       document.getElementById('createImageUrl').value.trim()       || null,
            detailImage: document.getElementById('createDetailImageUrl').value.trim() || null,
        };

        console.log('ğŸ“¦ ìƒí’ˆ ë“±ë¡ ìš”ì²­:', data);

        try {
            const res = await fetch(`${BASE_URL}/admin/products`, getRequestOptions('POST', data));

            if (res.status === 201) {
                alert('ìƒí’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!   ');
                closeCreateModal();
                loadProducts(0);
            } else {
                const err = await res.json().catch(() => ({}));
                alert(`ë“±ë¡ ì‹¤íŒ¨: ${err.message ?? 'ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'}`);
            }
        } catch (e) {
            console.error('ë“±ë¡ ì¤‘ ì˜¤ë¥˜:', e);
            alert('ì„œë²„ì™€ì˜ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ìƒí’ˆ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function openEditModal(id) {
        currentId = id;
        try {
            const res    = await fetch(`${BASE_URL}/admin/products/${id}`, getRequestOptions());
            const result = await res.json();

            if (!result?.data) {
                console.error('ìƒí’ˆ ìƒì„¸ ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
                return;
            }

            const p = result.data;

            // ì¹´í…Œê³ ë¦¬ select ë™ê¸°í™”
            document.getElementById('editCategorySelect').value = p.categoryId  ?? '';
            document.getElementById('editName').value           = p.name        ?? '';
            document.getElementById('editPrice').value          = p.price       ?? 0;
            document.getElementById('editQuantity').value       = p.quantity    ?? 0;
            document.getElementById('editInformation').value    = p.information ?? '';
            document.getElementById('editStatus').value         = p.status      ?? 'BEFORE_SALE';
            // ì´ë¯¸ì§€ URL â€“ ìˆìœ¼ë©´ í‘œì‹œ, ì—†ìœ¼ë©´ ë¹ˆ ì¹¸ (ì„ íƒì )
            document.getElementById('editImageUrl').value       = p.imageUrl       ?? '';
            document.getElementById('editDetailImageUrl').value = p.detailImageUrl ?? '';

            document.getElementById('editModal').classList.add('active');
        } catch (e) {
            console.error('ìƒì„¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:', e);
            alert('ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }

    function closeEditModal() {
        document.getElementById('editModal').classList.remove('active');
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ìƒí’ˆ ìˆ˜ì • ì‹¤í–‰
    // PATCH /ssak3/admin/products/status
    //
    // DTO: ProductUpdateRequest
    //   categoryId, name, price, status,
    //   information, quantity, image, detailImage
    //
    // âš ï¸ ì´ë¯¸ì§€ëŠ” ë¹ˆ ë¬¸ìì—´ì´ë©´ nullë¡œ ì „ì†¡ (ê¸°ì¡´ ê°’ ìœ ì§€ ì˜ë„)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function updateProduct() {
        if (!currentId) return;

        // 1. ë°ì´í„° ìˆ˜ì§‘ (ë°±ì—”ë“œ ProductUpdateRequest í•„ë“œëª…ê³¼ ì¼ì¹˜ì‹œí‚´)
        const data = {
            categoryId:  Number(document.getElementById('editCategorySelect').value) || null,
            name:        document.getElementById('editName').value.trim(),
            price:       parseInt(document.getElementById('editPrice').value) || 0,
            status:      document.getElementById('editStatus').value, // ğŸ’¡ ì—¬ê¸°ì„œ ìƒíƒœê°’ë„ ë³´ëƒ„
            information: document.getElementById('editInformation').value.trim() || null,
            quantity:    parseInt(document.getElementById('editQuantity').value) || 0,
            image:       document.getElementById('editImageUrl').value.trim() || null,
            detailImage: document.getElementById('editDetailImageUrl').value.trim() || null
        };

        console.log('âœï¸ ì „ì²´ ìˆ˜ì • ìš”ì²­ (ìƒíƒœ í¬í•¨):', data);

        try {
            // 2. ì „ì²´ ìˆ˜ì • API ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ (URL ëì— IDê°€ ë¶™ëŠ” í˜•íƒœ)
            // /ssak3/admin/products/{productId}
            const res = await fetch(`${BASE_URL}/admin/products/${currentId}`,
                getRequestOptions('PATCH', data));

            if (res.ok) {
                alert('ìƒí’ˆ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
                closeEditModal();
                loadProducts(currentPage);
            } else {
                const err = await res.json().catch(() => ({}));
                alert(`ìˆ˜ì • ì‹¤íŒ¨: ${err.message ?? 'ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜'}`);
            }
        } catch (e) {
            console.error('ìˆ˜ì • í†µì‹  ì˜¤ë¥˜:', e);
        }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // ë¡œê·¸ì•„ì›ƒ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('logoutBtn')?.addEventListener('click', () => {
        localStorage.removeItem('accessToken');
        location.href = 'login.html';
    });
</script>
</body>
</html>